const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/install-BgvAUDLg.js","assets/react-vendor-DweroVZ6.js","assets/monaco-vendor-Bo5OUYwx.js","assets/rolldown-runtime-y2wrX6ue.js","assets/login-hA3OC041.js","assets/home-Di7f7uBF.js","assets/sub-pBCNrzWi.js","assets/admin-Bv5mAdT5.js","assets/header-y5TsIIRS.js","assets/profile-DKqAcxbD.js","assets/files-BJz6v2w5.js"])))=>i.map(i=>d[i]);
import{a as e,c as t,d as n,f as r,i,m as a,n as o,o as s,r as c,s as l,u}from"./react-vendor-DweroVZ6.js";(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var d=r(),f=a(),p=n(),m=(0,f.createContext)({theme:`system`,setTheme:()=>null});function h({children:e,defaultTheme:t=`system`,storageKey:n=`vite-ui-theme`}){let[r,i]=(0,f.useState)(()=>localStorage.getItem(n)||t);(0,f.useEffect)(()=>{let e=window.document.documentElement;if(e.classList.remove(`light`,`dark`),r===`system`){let t=window.matchMedia(`(prefers-color-scheme: dark)`).matches?`dark`:`light`;e.classList.add(t);return}e.classList.add(r)},[r]);let a={theme:r,setTheme:e=>{localStorage.setItem(n,e),i(e)}};return(0,p.jsx)(m.Provider,{value:a,children:e})}const g=()=>{let e=(0,f.useContext)(m);if(e===void 0)throw Error(`useTheme must be used within a ThemeProvider`);return e};var _=(0,f.createContext)(void 0);function v({children:e}){let[t,n]=(0,f.useState)(!1),[r,i]=(0,f.useState)(!0),[a,o]=(0,f.useState)(!1),s=async()=>{try{let e=await fetch(`/post/user`,{method:`POST`,headers:{"Content-Type":`application/json`}});if(e.ok){let t=await e.json();return n(!0),o(t.user?.is_root===!0),!0}else return n(!1),o(!1),!1}catch(e){return console.error(`Auth check failed:`,e),n(!1),o(!1),!1}finally{i(!1)}};return(0,f.useEffect)(()=>{s()},[]),(0,p.jsx)(_.Provider,{value:{isAuthenticated:t,isLoading:r,isRoot:a,login:async(e,t)=>{try{let r=await fetch(`/post/user/auth`,{method:`POST`,headers:{"Content-Type":`application/json`},body:JSON.stringify({username:e,password:t})});if(!r.ok)throw Error(`Login failed`);if((await r.json()).status===`ok`)n(!0),await s();else throw Error(`Login failed`)}catch(e){throw console.error(`Login error:`,e),e}},logout:()=>{document.cookie.split(`;`).forEach(e=>{let t=e.split(`=`)[0].trim();t.startsWith(`mta_session_`)&&(document.cookie=`${t}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`)}),n(!1),o(!1)},checkAuth:s},children:e})}function y(){let e=(0,f.useContext)(_);if(e===void 0)throw Error(`useAuth must be used within an AuthProvider`);return e}var b=(0,f.createContext)(void 0);function x({children:e}){let{isAuthenticated:t,isLoading:n}=y(),[r,i]=(0,f.useState)([]),[a,o]=(0,f.useState)(!0),[s,c]=(0,f.useState)(!0),l=async()=>{try{let e=await fetch(`/post/app`,{method:`POST`,headers:{"Content-Type":`application/json`}});if(e.ok){let n=await e.json();if(n.installed!==void 0&&c(n.installed),t){let e=n.modules||{};i(Array.isArray(e)?e:Object.values(e))}}}catch(e){console.error(`Failed to fetch app configuration:`,e)}finally{o(!1)}};return(0,f.useEffect)(()=>{n||l()},[t,n]),(0,p.jsx)(b.Provider,{value:{moduleItems:r,isLoading:a,isInstalled:s,refresh:l},children:e})}function S(){let e=(0,f.useContext)(b);if(e===void 0)throw Error(`useApp must be used within an AppProvider`);return e}var C=(0,f.createContext)(void 0);function w({children:e}){let{isAuthenticated:t,isLoading:n}=y(),[r,i]=(0,f.useState)(null),[a,o]=(0,f.useState)(!0),s=async()=>{if(!t){i(null),o(!1);return}try{let e=await fetch(`/post/user`,{method:`POST`,headers:{"Content-Type":`application/json`}});if(e.ok){let t=await e.json();t.user&&i(t.user)}}catch(e){console.error(`Failed to fetch user configuration:`,e)}finally{o(!1)}};return(0,f.useEffect)(()=>{n||(t?s():(i(null),o(!1)))},[t,n]),(0,p.jsx)(C.Provider,{value:{user:r,isLoading:a,refreshUser:s},children:e})}function T(){let e=(0,f.useContext)(C);if(e===void 0)throw Error(`useUser must be used within a UserProvider`);return e}var E=(0,f.lazy)(()=>u(()=>import(`./install-BgvAUDLg.js`),__vite__mapDeps([0,1,2,3])));function D({bodyClasses:t=[]}){let{isInstalled:n,isLoading:r}=S();return(0,f.useEffect)(()=>{let e=[...n?[`bg-background-main`,`text-text-main`,`min-h-screen`,`w-full`,`flex`,`items-center`,`justify-center`,`font-sans`]:[`bg-gradient-to-br`,`from-slate-50`,`to-slate-200`,`dark:from-slate-900`,`dark:to-slate-800`,`font-display`,`min-h-screen`,`flex`,`items-center`,`justify-center`,`p-6`],...t],r=document.getElementById(`root`);if(r)return r.classList.add(...e),()=>{r.classList.remove(...e)}},[t,n]),r?null:n?(0,p.jsx)(e,{}):(0,p.jsx)(E,{})}var O=`/assets/logo-mWyI5jjv.svg`;function k(){let[e,n]=(0,f.useState)(!1),r=(0,f.useRef)(null),i=t(),{logout:a}=y(),{moduleItems:o}=S(),{user:s}=T(),{theme:l,setTheme:u}=g(),d=e=>!!(e===`/`&&i.pathname===`/`||e===`/admin`&&(i.pathname===`/admin`||i.pathname===`/admin/`)||e!==`/`&&e!==`/admin`&&i.pathname.startsWith(e));return(0,f.useEffect)(()=>{function e(e){r.current&&!r.current.contains(e.target)&&n(!1)}return document.addEventListener(`mousedown`,e),()=>{document.removeEventListener(`mousedown`,e)}},[]),(0,p.jsxs)(`aside`,{className:`w-[50px] bg-sidebar-slim border-r border-border-light flex flex-col items-center gap-0 z-50 shrink-0 pb-6`,children:[(0,p.jsx)(`div`,{className:`h-12 w-full flex items-center justify-center border-b border-border-light shrink-0 mb-2`,children:(0,p.jsx)(`img`,{src:O,alt:`Logo`,className:`size-8`})}),(0,p.jsxs)(`nav`,{className:`flex flex-col gap-1 w-full items-center`,children:[(0,p.jsxs)(c,{to:`/admin`,className:`w-full aspect-square flex items-center justify-center transition-all group relative ${d(`/admin`)?`text-primary`:`text-text-secondary hover:text-primary`}`,children:[d(`/admin`)&&(0,p.jsx)(`div`,{className:`absolute left-0 top-1/2 -translate-y-1/2 w-0.5 h-6 bg-primary`}),(0,p.jsx)(`span`,{className:`material-symbols-outlined text-[24px] ${d(`/admin`)?`filled shadow-sm`:``}`,style:d(`/admin`)?{fontVariationSettings:`'FILL' 1`}:{},children:`dashboard`}),(0,p.jsx)(`span`,{className:`absolute left-14 bg-text-main text-background-main text-[11px] px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-50 shadow-md font-medium`,children:`Dashboard`})]}),o.filter(e=>e.path!==`/`).map(e=>(0,p.jsxs)(c,{to:e.path,className:`w-full aspect-square flex items-center justify-center transition-all group relative ${d(e.path)?`text-primary`:`text-text-secondary hover:text-primary`}`,children:[d(e.path)&&(0,p.jsx)(`div`,{className:`absolute left-0 top-1/2 -translate-y-1/2 w-0.5 h-6 bg-primary`}),(0,p.jsx)(`span`,{className:`material-symbols-outlined text-[24px] ${d(e.path)?`filled shadow-sm`:``}`,style:d(e.path)?{fontVariationSettings:`'FILL' 1`}:{},children:e.icon||`circle`}),(0,p.jsx)(`span`,{className:`absolute left-14 bg-text-main text-background-main text-[11px] px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-50 shadow-md font-medium`,children:e.name})]},e.path))]}),(0,p.jsxs)(`div`,{className:`mt-auto flex flex-col gap-4 items-center relative`,ref:r,children:[(0,p.jsx)(`button`,{className:`size-8 rounded-full bg-slate-200 dark:bg-slate-700 border border-border-light cursor-pointer transition-transform hover:scale-105 active:scale-95 flex items-center justify-center overflow-hidden`,onClick:()=>n(!e),children:s?.username?(0,p.jsx)(`span`,{className:`text-[10px] font-bold text-text-main uppercase`,children:s.username.substring(0,2)}):(0,p.jsx)(`span`,{className:`material-symbols-outlined text-[18px]`,children:`person`})}),e&&(0,p.jsxs)(`div`,{className:`absolute left-[calc(100%+8px)] bottom-0 w-64 bg-card-bg rounded-lg shadow-2xl border border-border-light py-2 z-50 animate-in fade-in slide-in-from-left-2 duration-200`,children:[(0,p.jsx)(`div`,{className:`px-5 py-3 border-b border-border-light bg-background-light/30 rounded-t-lg -mt-2 mb-1`,children:(0,p.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,p.jsx)(`div`,{className:`size-9 rounded-full bg-primary/10 flex items-center justify-center border border-border-light`,children:(0,p.jsx)(`span`,{className:`text-xs font-bold text-primary uppercase`,children:s?.username?.substring(0,2)})}),(0,p.jsxs)(`div`,{className:`overflow-hidden`,children:[(0,p.jsx)(`p`,{className:`text-sm font-bold text-text-main truncate`,children:s?.username}),(0,p.jsx)(`p`,{className:`text-[10px] text-text-secondary font-medium truncate`,children:`Administrator`})]})]})}),(0,p.jsx)(`div`,{className:`py-1 px-1`,children:(0,p.jsxs)(c,{to:`/admin/profile`,className:`flex items-center gap-3 px-3 py-1.5 text-[13px] rounded transition-colors font-medium ${d(`/admin/profile`)?`bg-primary/10 text-primary`:`text-text-secondary hover:bg-primary/5 hover:text-primary`}`,children:[(0,p.jsx)(`span`,{className:`material-symbols-outlined text-[18px]`,children:`person`}),`Account Profile`]})}),(0,p.jsxs)(`div`,{className:`border-t border-border-light mt-1 pt-3 px-3 pb-2`,children:[(0,p.jsx)(`p`,{className:`text-[10px] font-bold text-text-muted uppercase tracking-wider mb-2`,children:`Color Mode`}),(0,p.jsxs)(`div`,{className:`flex bg-background-light p-1 rounded-lg`,children:[(0,p.jsxs)(`button`,{onClick:()=>u(`light`),className:`flex items-center justify-center gap-1.5 py-1.5 px-2 rounded-md text-[10px] font-bold transition-all flex-1 ${l===`light`?`bg-card-bg text-primary shadow-sm`:`text-text-secondary hover:text-text-main`}`,children:[(0,p.jsx)(`span`,{className:`material-symbols-outlined text-[14px]`,children:`light_mode`}),`Light`]}),(0,p.jsxs)(`button`,{onClick:()=>u(`dark`),className:`flex items-center justify-center gap-1.5 py-1.5 px-2 rounded-md text-[10px] font-bold transition-all flex-1 ${l===`dark`?`bg-card-bg text-primary shadow-sm`:`text-text-secondary hover:text-text-main`}`,children:[(0,p.jsx)(`span`,{className:`material-symbols-outlined text-[14px]`,children:`dark_mode`}),`Dark`]})]})]}),(0,p.jsx)(`div`,{className:`border-t border-border-light mt-1 pt-1 px-1`,children:(0,p.jsxs)(`button`,{onClick:a,className:`w-full flex items-center gap-3 px-3 py-1.5 text-[13px] text-red-500 hover:bg-red-500/10 rounded transition-colors text-left font-bold`,children:[(0,p.jsx)(`span`,{className:`material-symbols-outlined text-[18px]`,children:`logout`}),`Sign Out`]})})]})]})]})}function A({bodyClasses:t=[]}){let{isAuthenticated:n,isLoading:r}=y();return(0,f.useEffect)(()=>{let e=[...[`bg-background-main`,`text-text-main`,`h-screen`,`w-full`,`flex`,`overflow-hidden`,`font-sans`],...t],n=document.getElementById(`root`);if(n)return n.classList.add(...e),()=>{n.classList.remove(...e)}},[t]),r?null:n?(0,p.jsxs)(`div`,{className:`bg-background-main text-text-main h-screen w-full flex overflow-hidden font-sans`,children:[(0,p.jsx)(k,{}),(0,p.jsx)(e,{})]}):(0,p.jsx)(i,{to:`/login`,replace:!0})}function j({bodyClasses:e=[]}){return(0,f.useEffect)(()=>{let t=[...[`bg-background-light`,`dark:bg-background-dark`,`font-display`,`text-[#0d121b]`,`dark:text-white`,`transition-colors`,`duration-200`],...e],n=document.getElementById(`root`);if(n)return n.classList.add(...t),()=>{n.classList.remove(...t)}},[e]),(0,p.jsxs)(`div`,{className:`relative flex min-h-screen w-full flex-col items-center justify-center overflow-x-hidden p-6`,children:[(0,p.jsxs)(`div`,{className:`flex flex-col items-center max-w-[560px] w-full`,children:[(0,p.jsx)(`div`,{className:`relative mb-8`,children:(0,p.jsx)(`div`,{className:`bg-white dark:bg-[#1e293b] rounded-full shadow-lg p-12 flex items-center justify-center border border-slate-100 dark:border-slate-800`,children:(0,p.jsxs)(`div`,{className:`relative w-16 h-16`,children:[(0,p.jsx)(`div`,{className:`absolute inset-0 border-4 border-primary/10 rounded-full`}),(0,p.jsx)(`div`,{className:`absolute inset-0 border-4 border-transparent border-t-primary rounded-full animate-spin`})]})})}),(0,p.jsxs)(`div`,{className:`flex flex-col items-center gap-3 text-center`,children:[(0,p.jsx)(`h1`,{className:`text-[#0d121b] dark:text-white text-xl font-medium tracking-tight`,children:`Loading Application...`}),(0,p.jsx)(`p`,{className:`text-slate-500 dark:text-slate-400 text-sm font-normal`,children:`Setting up your secure environment`})]})]}),(0,p.jsx)(`div`,{className:`fixed bottom-0 left-0 w-full h-1 bg-primary/5`,children:(0,p.jsx)(`div`,{className:`h-full bg-primary/30 w-1/3 animate-[loading_2s_ease-in-out_infinite]`})}),(0,p.jsx)(`style`,{children:`
                @keyframes loading {
                    0% { transform: translateX(-100%); }
                    100% { transform: translateX(300%); }
                }
            `})]})}var M=(0,f.lazy)(()=>u(()=>import(`./login-hA3OC041.js`),__vite__mapDeps([4,1,2,3]))),N=(0,f.lazy)(()=>u(()=>import(`./home-Di7f7uBF.js`),__vite__mapDeps([5,1,2,3]))),P=(0,f.lazy)(()=>u(()=>import(`./sub-pBCNrzWi.js`),__vite__mapDeps([6,1,2,3]))),F=(0,f.lazy)(()=>u(()=>import(`./admin-Bv5mAdT5.js`),__vite__mapDeps([7,1,2,3,8]))),I=(0,f.lazy)(()=>u(()=>import(`./profile-DKqAcxbD.js`),__vite__mapDeps([9,1,2,3,8]))),L=(0,f.lazy)(()=>u(()=>import(`./files-BJz6v2w5.js`),__vite__mapDeps([10,1,2,3,8])));function R(){return(0,p.jsx)(o,{children:(0,p.jsx)(f.Suspense,{fallback:(0,p.jsx)(j,{}),children:(0,p.jsxs)(l,{children:[(0,p.jsxs)(s,{path:`/`,element:(0,p.jsx)(D,{}),children:[(0,p.jsx)(s,{index:!0,element:(0,p.jsx)(N,{})}),(0,p.jsx)(s,{path:`login`,element:(0,p.jsx)(M,{})}),(0,p.jsx)(s,{path:`*`,element:(0,p.jsx)(P,{})})]}),(0,p.jsxs)(s,{path:`admin/`,element:(0,p.jsx)(A,{}),children:[(0,p.jsx)(s,{index:!0,element:(0,p.jsx)(F,{})}),(0,p.jsx)(s,{path:`profile`,element:(0,p.jsx)(I,{})}),(0,p.jsx)(s,{path:`tools/files`,element:(0,p.jsx)(L,{})})]})]})})})}function z(){return(0,p.jsx)(f.StrictMode,{children:(0,p.jsx)(h,{defaultTheme:`light`,storageKey:`vite-ui-theme`,children:(0,p.jsx)(v,{children:(0,p.jsx)(w,{children:(0,p.jsx)(x,{children:(0,p.jsx)(R,{})})})})})})}(0,d.createRoot)(document.getElementById(`root`)).render((0,p.jsx)(z,{}));export{y as n,g as r,T as t};